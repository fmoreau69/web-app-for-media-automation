{% extends 'base.html' %}
{% load static %}

{% block javascript %}
{# JQUERY FILE UPLOAD SCRIPTS #}
<script src="{% static 'js/jquery-file-upload/vendor/jquery.ui.widget.js' %}"></script>
<script src="{% static 'js/jquery-file-upload/jquery.iframe-transport.js' %}"></script>
<script src="{% static 'js/jquery-file-upload/jquery.fileupload.js' %}"></script>

{# MEDIAS PAGE SCRIPTS #}
<script src="{% static 'medias/js/process.js' %}"></script>
<script src="{% static 'medias/js/update.js' %}"></script>
<script src="{% static 'medias/js/upload.js' %}"></script>
{% endblock %}

{% block content %}
<h1 class="page-header">
    WAMA
    <small>/ {% block title %}{% endblock %}</small>
</h1>
<hr>
<div class="row">
    <div class="col-md-3">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Menu</h3>
            </div>
            <div class="list-group">
                <a href="{% url 'medias:upload' %}" class="list-group-item {% if request.path == '/medias/upload/' %} active {% endif %}">
                    <span class="fas fa-upload"></span> <span>Upload / </span> <span class="fas fa-spinner"></span> <span>Process</span>
                </a>
                <a href="{% url 'medias:about' %}" class="list-group-item {% if request.path == '/medias/about/' %} active {% endif %}">
                    <span class="fas fa-circle-info"></span> <span>About</span>
                </a>
                <a href="{% url 'medias:help' %}" class="list-group-item {% if request.path == '/medias/help/' %} active {% endif %}">
                    <span class="fas fa-circle-question"></span> <span>Help</span>
                </a>
            </div>
        </div>
        <br>
        <div>
            <form method="post" action="{% url 'medias:expand_area' %}">
                {% csrf_token %}
                <a class="btn btn-info" id="button_show_console" data-bs-toggle="collapse" href="#collapseConsole"
                   aria-expanded="false" aria-controls="collapseConsole">
                    <i class="fas fa-display"></i> Display console
                </a>
            </form>
        </div>
        <div {% if user.user_settings.show_console %} class="collapse show" {% else %} class="collapse" {% endif %} id="collapseConsole">
            <hr>
            <h1 class="text-center">Console</h1>
            <div id="console-logs-container" style="max-height: 350px; overflow-y: auto; background-color: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; font-size: 12px;">
                <div id="console-logs-content">
                    {% if console %}
                        {% for content in console %}
                        <div style="margin-bottom: 2px; white-space: pre-wrap; word-wrap: break-word;">{{ content }}</div>
                        {% endfor %}
                    {% else %}
                        <div class="text-center" style="padding: 20px;">Aucun log disponible.<br>Les logs Celery worker appara√Ætront ici.</div>
                    {% endif %}
                </div>
            </div>
            <br>
            <br>
        </div>
    </div>
    <div class="col-md-9">
        {% block medias_content %}
        {% endblock %}
    </div>
</div>
{% endblock %}