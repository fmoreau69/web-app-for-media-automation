<hr>
<div class="row mb-3">
    <div class="col-3 d-flex justify-content-left"></div>
    <div class="col-6">
        <h2 class="text-center">Global Settings</h2>
    </div>
    <div class="col-3">
        <form method="post" action="{% url 'anonymizer:reset_user_settings' %}" class="ajax-form"
              data-target="#global_settings_container">
            {% csrf_token %}
            <input type="hidden" class="reset-button" name="next" value="{{ request.path }}">
            <button type="submit" class="btn btn-danger float-end">
                <i class="fas fa-rotate-left"></i> Reset Settings
            </button>
        </form>
    </div>
</div>

<table id="options" class="table table-bordered">
    <thead>
    <tr>
        <td class="fw-bold text-center text-bg-secondary">What to blur ?</td>
        <td class="fw-bold text-center text-bg-secondary">How to blur ?</td>
        <td class="fw-bold text-center text-bg-secondary">What to show ?</td>
    </tr>
    </thead>
</table>

<div class="row">
    <!-- What to blur (col-4) -->
    <div class="col-4 d-flex flex-column align-items-center">
        {% for setting in global_settings %}
            {% if setting.label == 'WTB' %}
                {% if setting.name == 'classes2blur' %}
                    {% include "widgets/CheckboxMultipleModal.html" with field=user_settings_form.classes2blur id=user.id setting_type='user_setting' value=gs_values|get_value:setting.name button_width=4 %}
                    <div class="mt-3" style="width: 100%; max-width: 320px;">
                        <select id="user_setting_model_to_use" class="form-select setting-button">
                            {% for model_type, model_list in models_by_type.items %}
                                {% if model_type == 'detect' %}
                                    <optgroup label="Detection">
                                {% elif model_type == 'segment' %}
                                    <optgroup label="Segmentation">
                                {% elif model_type == 'classify' %}
                                    <optgroup label="Classification">
                                {% elif model_type == 'pose' %}
                                    <optgroup label="Pose Estimation">
                                {% elif model_type == 'obb' %}
                                    <optgroup label="Oriented Bounding Box">
                                {% elif model_type == 'root' %}
                                    <optgroup label="Legacy (Root Directory)">
                                {% else %}
                                    <optgroup label="{{ model_type|title }}">
                                {% endif %}
                                    {% for model_name in model_list %}
                                        {% if model_type == 'root' %}
                                            <option value="{{ model_name }}" {% if gs_values.model_to_use == model_name %}selected{% endif %}>{{ model_name }}</option>
                                        {% else %}
                                            <option value="{{ model_type }}/{{ model_name }}" {% if gs_values.model_to_use == model_name or gs_values.model_to_use|stringformat:'s' == model_type|add:'/'|add:model_name %}selected{% endif %}>{{ model_name }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </optgroup>
                            {% endfor %}
                        </select>
                        <label class="form-label fw-bold" for="user_setting_model_to_use">Model to use</label>
                    </div>
                {% endif %}
            {% endif %}
        {% endfor %}
    </div>

    <!-- How to blur (col-4) -->
    <div class="col-4 d-flex flex-column align-items-center">
        <div>
        {% for setting in global_settings %}
            {% if setting.label == 'HTB' %}
                {% include 'anonymizer/upload/setting_button.html' with id=user.id setting_type='user_setting' value=gs_values|get_value:setting.name range_width='col-sm-3' %}
            {% endif %}
        {% endfor %}
        </div>
    </div>

    <!-- What to show (col-4) -->
    <div class="col-4 d-flex flex-column">
        {% for setting in global_settings %}
            {% if setting.label == 'WTS' %}
                {% include 'anonymizer/upload/setting_button.html' with id=user.id setting_type='user_setting' value=gs_values|get_value:setting.name range_width='col-sm-3' %}
            {% endif %}
        {% endfor %}
    </div>
</div>
<br>
