{% extends 'base.html' %}
{% load static %}

{% block javascript %}
{# JQUERY FILE UPLOAD SCRIPTS - Optionnel, peut être surchargé #}
{% block extra_scripts %}
<script src="{% static 'js/jquery-file-upload/vendor/jquery.ui.widget.js' %}"></script>
<script src="{% static 'js/jquery-file-upload/jquery.iframe-transport.js' %}"></script>
<script src="{% static 'js/jquery-file-upload/jquery.fileupload.js' %}"></script>
{% endblock %}

{# APP SPECIFIC SCRIPTS - Fourni par l'app qui hérite #}
{% block app_scripts %}
{# Les apps héritant de ce template doivent définir ce bloc #}
{% endblock %}

{# CONSOLE SCRIPT - Commun à toutes les apps #}
<script src="{% static 'common/js/console.js' %}"></script>

{% endblock %}

{% block content %}
<style>
    /* Ne pas bloquer le scroll sur body/html pour permettre aux modals Bootstrap de fonctionner */
    .container {
        max-width: 1200px; /* Limite la largeur maximale */
        margin: 0 auto; /* Centre le contenu */
        padding-left: 15px;
        padding-right: 15px;
        position: relative;
        z-index: 1;
    }
    /* Conteneur principal avec hauteur fixe */
    .app-wrapper {
        display: flex;
        flex-direction: column;
        height: calc(100vh - 60px); /* 60px pour la navigation top */
        position: relative;
        z-index: 1;
        overflow: hidden; /* Bloquer le scroll seulement sur ce conteneur */
    }
    .app-header {
        flex-shrink: 0;
    }
    .app-body {
        flex: 1;
        overflow: hidden;
        display: flex;
        position: relative;
    }
    .app-sidebar {
        width: 25%;
        overflow-y: auto;
        overflow-x: hidden;
        padding-right: 15px;
        padding-bottom: 50px;
        /* Masquer la scrollbar tout en gardant la fonctionnalité */
        scrollbar-width: thin;
        scrollbar-color: rgba(155, 155, 155, 0.5) transparent;
    }
    .app-sidebar::-webkit-scrollbar {
        width: 6px;
    }
    .app-sidebar::-webkit-scrollbar-track {
        background: transparent;
    }
    .app-sidebar::-webkit-scrollbar-thumb {
        background-color: rgba(155, 155, 155, 0.5);
        border-radius: 3px;
    }
    .app-content {
        width: 75%;
        overflow-y: auto;
        overflow-x: hidden;
        padding-left: 15px;
        padding-bottom: 50px;
        /* Masquer la scrollbar tout en gardant la fonctionnalité */
        scrollbar-width: thin;
        scrollbar-color: rgba(155, 155, 155, 0.5) transparent;
    }
    .app-content::-webkit-scrollbar {
        width: 6px;
    }
    .app-content::-webkit-scrollbar-track {
        background: transparent;
    }
    .app-content::-webkit-scrollbar-thumb {
        background-color: rgba(155, 155, 155, 0.5);
        border-radius: 3px;
    }
</style>

<div class="app-wrapper">
    {# HEADER FIXE #}
    <div class="app-header">
        <h1 class="page-header" style="margin-top: 0;">
            WAMA
            <small>/ {% block title %}{% endblock %}</small>
        </h1>
        <hr style="margin-top: 10px; margin-bottom: 10px;">
    </div>

    {# CONTENEUR AVEC SCROLL #}
    <div class="app-body">
        {# SIDEBAR FIXE AVEC SCROLL INTERNE #}
        <div class="app-sidebar">
        {# MENU - Fourni par l'app qui hérite #}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Menu</h3>
            </div>
            <div class="list-group">
                {% block app_menu %}
                {# Les apps héritant de ce template doivent définir ce bloc #}
                {% endblock %}
            </div>
        </div>

        {# CONSOLE - Commune à toutes les apps #}
        <div class="panel panel-default mt-3">
            <div class="panel-heading d-flex justify-content-between align-items-center">
                <h3 class="panel-title mb-0">Console</h3>
                <small class="text-muted" id="{% block console_hint_id %}console-hint{% endblock %}">Live logs</small>
            </div>
            <div class="panel-body" style="max-height: 320px; overflow-y: auto; background: #111; color: #e4e4e4; font-family: 'Courier New', monospace; font-size: 12px;">
                <div id="{% block console_content_id %}console-content{% endblock %}"
                     data-console-url="{% block console_url %}{% endblock %}">
                    <p class="text-muted mb-0">Chargement des logs...</p>
                </div>
            </div>
        </div>
        </div>

        {# CONTENU PRINCIPAL AVEC SCROLL #}
        <div class="app-content">
            {% block app_content %}
            {# Les apps héritant de ce template doivent définir ce bloc #}
            {% endblock %}
        </div>
    </div>
</div>
{% endblock %}
